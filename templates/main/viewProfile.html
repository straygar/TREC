{% extends "main/base.html" %}
{% load static %}

{% block head %}
<script type="text/javascript" src="{% static 'js/chart.js' %}"></script>
{% endblock %}

{% block body_block %}
{% if thisUser %}
<div class="col-lg-6 col-md-12 col-sm-12 col-lg-offset-3">
	<a href="{% url 'edit_profile' %}" class="btn btn-info btn-block" role="button">Edit my profile</a>
</div>
{% endif %}
<div class="col-lg-6 col-md-12 col-sm-12 col-lg-offset-3 text-center">
	<h2>{{ profile.display_name }}'s profile</h2>
	<div class="profile-img">
		{% if profile.profile_picture %}
			<img class="img-circle avatar" src="{{ profile.profile_picture.url }}" alt="User profile picture" />
		{% else %}
			<img class="img-circle avatar" src="{% static 'images/place.png' %}" alt="User profile picture" />
		{% endif %}
	</div>
</div>
<div class="col-lg-12 col-md-12 col-sm-12">
	<h4>Details</h4>
	<div id="chart_div"></div>
	<table class="table-striped table-bordered table-hover table table-responsive">
		<tr>
			<td>Username</td>
			<td>{{ user.username }}</td>
		</tr>
		<tr>
			<td>Display name</td>
			<td>{{ profile.display_name }}</td>
		</tr>
		<tr>
			<td>Organization</td>
			<td>{{ profile.organization|default:"Not provided" }}</td>
		</tr>
		<tr>
			<td>Website</td>
			<td><a href="{{ profile.website|default:'#' }}">{{ profile.website|default:"Not provided" }}</a></td>
		</tr>
		<tr>
			<td>Member since</td>
			<td>{{ user.date_joined|date:"d-m-Y" }}</td>
		</tr>
		<tr>
			<td>Last 5 runs</td>
			<td>
				{% if runs %}
					<table class="table-striped sortable table-bordered table-hover table table-responsive">
						<thead>
							<th>Date</th>
							<th>Run title</th>
							<th>Description</th>
							<th>Track</th>
							<th>Task</th>
							<th>P10</th>
							<th>P20</th>
							<th>Map</th>
						</thead>
						<tbody>
							{% for run in runs %}
								<tr>
									<td>{{ run.datetime|date:"d-m-Y H:m" }}</td>
									<td><a href="{% url 'view_run' runid=run.id %}">{{ run.name }}</a></td>
									<td>{{ run.description }}</td>
									<td><a href="{% url 'view_track' trackid=run.task.track.id %}">
										{{ run.task.track.title }}
									</a></td>
									<td><a href="{% url 'view_task' taskid=run.task.id %}">
										{{ run.task }}</a></td>
									<td>{{ run.p10 }}</td>
									<td>{{ run.p20 }}</td>
									<td>{{ run.map }}
								</tr>
							{% endfor %}
						</tbody>
					</table>
				{% else %}
					This user has no runs yet
				{% endif %}
			</td>
		</tr>
	</table>
	<div>

	</div>
</div>
{% endblock %}